---
- hosts: all
  gather_facts: false
  ignore_unreachable: yes
  tasks:
    - name: Create auth rule
      cisco.ise.network_access_authorization_rules:
        ise_hostname: "{{ ansible_host }}"
        ise_verify: "{{ ise_verify }}"
        policyId: "{{ policyid }}"
        #id: "{{ id }}"
        state: present
        profile: "{{ item.profiles }}"
        rule:
          #id: "{{ id }}"
          name: "{{ item.rule_name }}"
          condition:
            attributeName: "uid"
            attributeValue: "{{ item.rule_name }}"
            conditionType: "ConditionAttributes"
            dictionaryName: "OpenLDAP"
            operator: "equals"
      loop: "{{ auth_profile_input }}"
      register: results2
    # - name: Display 
    #   debug:
    #     var: results2